# 🏛️ 廣清宮記帳軟體 - 雲端同步使用指南

## 🚀 快速開始

### 1. 啟動HTTP服務器（重要！）

為了使用完整的雲端同步和QR Code功能，您需要啟動HTTP服務器：

#### 方法一：使用批次檔案（推薦）
```bash
# 雙擊執行
start-server.bat
```

#### 方法二：使用Node.js
```bash
# 在專案目錄中執行
node simple-server.js
```

#### 方法三：使用Python
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000
```

### 2. 開啟應用程式

服務器啟動後，在瀏覽器中開啟：
- **電腦端**：http://localhost:8000
- **手機端**：http://[您的IP地址]:8000

## ☁️ 雲端同步功能

### 同步到雲端
1. 在主程式中點擊「☁️ 同步到雲端」
2. 系統會自動上傳所有數據
3. 顯示同步成功訊息

### 從雲端同步
1. 點擊「📥 從雲端同步」
2. 確認覆蓋本地數據
3. 系統會下載雲端數據

### 同步狀態監控
在「數據備份與恢復」頁面可以查看：
- 🌐 網路狀態
- 🆔 同步ID
- ⏰ 最後同步時間
- 📊 雲端數據狀態

## 📱 手機安裝功能

### 電腦端操作
1. 點擊「📱 安裝到手機」
2. 系統顯示QR Code模態框
3. 點擊「☁️ 立即同步到雲端」上傳數據
4. 手機掃描QR Code

### 手機端操作
1. 掃描QR Code開啟網頁
2. 系統自動檢測並同步數據
3. 使用瀏覽器「加到主畫面」功能
4. 確認安裝到桌面

### PWA安裝步驟
- **Android Chrome**：選單 → 加到主畫面
- **iOS Safari**：分享 → 加到主畫面
- **Windows Edge**：選單 → 應用程式 → 安裝此網站

## 🔧 技術說明

### 雲端存儲方案
目前使用本地存儲模擬雲端功能：
- 數據存儲在瀏覽器的localStorage中
- 使用唯一同步ID識別設備
- 支援跨設備數據共享

### 同步機制
- **自動同步**：網路恢復時自動同步
- **手動同步**：用戶主動觸發同步
- **衝突處理**：後同步的數據覆蓋先前數據
- **備份機制**：同步前自動備份本地數據

### 數據安全
- 本地備份：每次同步前自動備份
- 版本控制：保留最近5個備份版本
- 數據驗證：同步時驗證數據完整性

## 🛠️ 故障排除

### CORS錯誤
**問題**：直接開啟HTML文件出現CORS錯誤
**解決**：必須使用HTTP服務器運行應用程式

### 同步失敗
**問題**：雲端同步失敗
**解決**：
1. 檢查網路連線
2. 確認使用HTTP服務器運行
3. 查看瀏覽器控制台錯誤訊息

### QR Code無法顯示
**問題**：點擊安裝到手機沒有反應
**解決**：
1. 確認使用HTTP服務器
2. 檢查JavaScript控制台錯誤
3. 重新整理頁面

### 手機無法訪問
**問題**：手機掃描QR Code無法開啟
**解決**：
1. 確認電腦和手機在同一網路
2. 檢查防火牆設定
3. 使用IP地址而非localhost

## 📊 測試工具

### 雲端同步測試
開啟 `test-cloud-sync.html` 進行功能測試：
- 同步狀態檢查
- 上傳/下載測試
- QR Code生成測試

### 數據匯入工具
使用 `import-test-data.html` 生成測試數據：
- 快速生成豐富測試數據
- 匯入/匯出備份檔案
- 清空所有數據

## 🔄 版本升級

### 從舊版本升級
1. 備份現有數據
2. 替換程式檔案
3. 使用HTTP服務器啟動
4. 恢復數據並測試同步功能

### 數據遷移
- 舊版本數據會自動保留
- 新增雲端同步功能
- 保持向下相容性

## 📞 技術支援

### 常見問題
1. **為什麼需要HTTP服務器？**
   - 解決瀏覽器CORS安全限制
   - 支援PWA完整功能
   - 啟用雲端同步功能

2. **數據存儲在哪裡？**
   - 本地：瀏覽器localStorage
   - 雲端：模擬存儲（可擴展為真實雲端服務）

3. **如何確保數據安全？**
   - 定期備份到本地檔案
   - 多設備同步確保數據不丟失
   - 版本控制機制

### 進階配置
- 可以修改 `cloud-sync.js` 整合真實雲端服務
- 支援自定義同步間隔
- 可配置備份保留數量

---

## 🎯 總結

通過HTTP服務器運行廣清宮記帳軟體，您可以享受：
- ✅ 完整的雲端同步功能
- 📱 便捷的QR Code安裝
- 🔄 跨設備數據一致性
- 🛡️ 安全的數據備份機制

現在就開始使用吧！🚀
