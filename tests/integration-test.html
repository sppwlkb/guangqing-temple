<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å»£æ¸…å®®è¨˜å¸³è»Ÿé«” - ç³»çµ±æ•´åˆæ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #409eff;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e4e7ed;
            border-radius: 6px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #303133;
            border-bottom: 1px solid #e4e7ed;
            padding-bottom: 10px;
        }
        .test-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f5f7fa;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .test-name {
            flex: 1;
            font-weight: 500;
        }
        .test-status {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-pending {
            background-color: #f4f4f5;
            color: #909399;
        }
        .status-running {
            background-color: #ecf5ff;
            color: #409eff;
        }
        .status-success {
            background-color: #f0f9ff;
            color: #67c23a;
        }
        .status-error {
            background-color: #fef0f0;
            color: #f56c6c;
        }
        .test-controls {
            text-align: center;
            margin: 30px 0;
        }
        .btn {
            padding: 10px 20px;
            margin: 0 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .btn-primary {
            background-color: #409eff;
            color: white;
        }
        .btn-success {
            background-color: #67c23a;
            color: white;
        }
        .btn-warning {
            background-color: #e6a23c;
            color: white;
        }
        .btn:hover {
            opacity: 0.8;
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .test-results {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 6px;
        }
        .result-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        .result-item {
            text-align: center;
        }
        .result-number {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .result-label {
            font-size: 12px;
            color: #666;
        }
        .test-log {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #e4e7ed;
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background-color: #409eff;
            transition: width 0.3s ease;
            width: 0%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>å»£æ¸…å®®å¿«é€Ÿè¨˜å¸³è»Ÿé«”</h1>
            <h2>ç³»çµ±æ•´åˆæ¸¬è©¦</h2>
            <p>å…¨é¢æ¸¬è©¦ç³»çµ±åŠŸèƒ½ï¼Œç¢ºä¿æ‰€æœ‰æ¨¡çµ„æ­£å¸¸é‹ä½œ</p>
        </div>

        <div class="test-controls">
            <button class="btn btn-primary" onclick="runAllTests()">åŸ·è¡Œå…¨éƒ¨æ¸¬è©¦</button>
            <button class="btn btn-success" onclick="runCriticalTests()">åŸ·è¡Œé—œéµæ¸¬è©¦</button>
            <button class="btn btn-warning" onclick="resetTests()">é‡ç½®æ¸¬è©¦</button>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <!-- æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦ -->
        <div class="test-section">
            <h3>ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦</h3>
            <div class="test-item">
                <span class="test-name">æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–</span>
                <span class="test-status status-pending" id="test-app-init">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">Pinia Store è¼‰å…¥</span>
                <span class="test-status status-pending" id="test-store-load">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">è·¯ç”±ç³»çµ±</span>
                <span class="test-status status-pending" id="test-routing">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">æœ¬åœ°å„²å­˜</span>
                <span class="test-status status-pending" id="test-local-storage">å¾…æ¸¬è©¦</span>
            </div>
        </div>

        <!-- Firebase æ•´åˆæ¸¬è©¦ -->
        <div class="test-section">
            <h3>â˜ï¸ Firebase æ•´åˆæ¸¬è©¦</h3>
            <div class="test-item">
                <span class="test-name">Firebase åˆå§‹åŒ–</span>
                <span class="test-status status-pending" id="test-firebase-init">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">èº«ä»½é©—è­‰æœå‹™</span>
                <span class="test-status status-pending" id="test-auth">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">Firestore é€£æ¥</span>
                <span class="test-status status-pending" id="test-firestore">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">é›¢ç·š/åœ¨ç·šåˆ‡æ›</span>
                <span class="test-status status-pending" id="test-offline">å¾…æ¸¬è©¦</span>
            </div>
        </div>

        <!-- æœƒè¨ˆåŠŸèƒ½æ¸¬è©¦ -->
        <div class="test-section">
            <h3>ğŸ’° æœƒè¨ˆåŠŸèƒ½æ¸¬è©¦</h3>
            <div class="test-item">
                <span class="test-name">æœƒè¨ˆç§‘ç›®ç®¡ç†</span>
                <span class="test-status status-pending" id="test-accounting">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">æ”¶å…¥è¨˜éŒ„</span>
                <span class="test-status status-pending" id="test-income">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">æ”¯å‡ºè¨˜éŒ„</span>
                <span class="test-status status-pending" id="test-expense">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">è²¡å‹™å ±è¡¨ç”Ÿæˆ</span>
                <span class="test-status status-pending" id="test-reports">å¾…æ¸¬è©¦</span>
            </div>
        </div>

        <!-- é€²éšåŠŸèƒ½æ¸¬è©¦ -->
        <div class="test-section">
            <h3>ğŸ“Š é€²éšåŠŸèƒ½æ¸¬è©¦</h3>
            <div class="test-item">
                <span class="test-name">è²¡å‹™åˆ†æ</span>
                <span class="test-status status-pending" id="test-analytics">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">ä¿¡çœ¾ç®¡ç†</span>
                <span class="test-status status-pending" id="test-believers">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">æ¬Šé™ç®¡ç†</span>
                <span class="test-status status-pending" id="test-permissions">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">UI è¨­å®š</span>
                <span class="test-status status-pending" id="test-ui-settings">å¾…æ¸¬è©¦</span>
            </div>
        </div>

        <!-- æ€§èƒ½æ¸¬è©¦ -->
        <div class="test-section">
            <h3>âš¡ æ€§èƒ½æ¸¬è©¦</h3>
            <div class="test-item">
                <span class="test-name">é é¢è¼‰å…¥é€Ÿåº¦</span>
                <span class="test-status status-pending" id="test-load-speed">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">å¤§æ•¸æ“šè™•ç†</span>
                <span class="test-status status-pending" id="test-big-data">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">è¨˜æ†¶é«”ä½¿ç”¨</span>
                <span class="test-status status-pending" id="test-memory">å¾…æ¸¬è©¦</span>
            </div>
            <div class="test-item">
                <span class="test-name">éŸ¿æ‡‰å¼è¨­è¨ˆ</span>
                <span class="test-status status-pending" id="test-responsive">å¾…æ¸¬è©¦</span>
            </div>
        </div>

        <!-- æ¸¬è©¦çµæœ -->
        <div class="test-results">
            <h3>ğŸ“‹ æ¸¬è©¦çµæœ</h3>
            <div class="result-summary">
                <div class="result-item">
                    <div class="result-number" id="total-tests">0</div>
                    <div class="result-label">ç¸½æ¸¬è©¦æ•¸</div>
                </div>
                <div class="result-item">
                    <div class="result-number" id="passed-tests" style="color: #67c23a;">0</div>
                    <div class="result-label">é€šé</div>
                </div>
                <div class="result-item">
                    <div class="result-number" id="failed-tests" style="color: #f56c6c;">0</div>
                    <div class="result-label">å¤±æ•—</div>
                </div>
                <div class="result-item">
                    <div class="result-number" id="success-rate">0%</div>
                    <div class="result-label">æˆåŠŸç‡</div>
                </div>
            </div>
            <div class="test-log" id="testLog">ç­‰å¾…æ¸¬è©¦é–‹å§‹...</div>
        </div>
    </div>

    <script>
        // æ¸¬è©¦é…ç½®
        const tests = [
            { id: 'test-app-init', name: 'æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–', critical: true },
            { id: 'test-store-load', name: 'Pinia Store è¼‰å…¥', critical: true },
            { id: 'test-routing', name: 'è·¯ç”±ç³»çµ±', critical: true },
            { id: 'test-local-storage', name: 'æœ¬åœ°å„²å­˜', critical: true },
            { id: 'test-firebase-init', name: 'Firebase åˆå§‹åŒ–', critical: true },
            { id: 'test-auth', name: 'èº«ä»½é©—è­‰æœå‹™', critical: true },
            { id: 'test-firestore', name: 'Firestore é€£æ¥', critical: true },
            { id: 'test-offline', name: 'é›¢ç·š/åœ¨ç·šåˆ‡æ›', critical: false },
            { id: 'test-accounting', name: 'æœƒè¨ˆç§‘ç›®ç®¡ç†', critical: true },
            { id: 'test-income', name: 'æ”¶å…¥è¨˜éŒ„', critical: true },
            { id: 'test-expense', name: 'æ”¯å‡ºè¨˜éŒ„', critical: true },
            { id: 'test-reports', name: 'è²¡å‹™å ±è¡¨ç”Ÿæˆ', critical: true },
            { id: 'test-analytics', name: 'è²¡å‹™åˆ†æ', critical: false },
            { id: 'test-believers', name: 'ä¿¡çœ¾ç®¡ç†', critical: false },
            { id: 'test-permissions', name: 'æ¬Šé™ç®¡ç†', critical: false },
            { id: 'test-ui-settings', name: 'UI è¨­å®š', critical: false },
            { id: 'test-load-speed', name: 'é é¢è¼‰å…¥é€Ÿåº¦', critical: false },
            { id: 'test-big-data', name: 'å¤§æ•¸æ“šè™•ç†', critical: false },
            { id: 'test-memory', name: 'è¨˜æ†¶é«”ä½¿ç”¨', critical: false },
            { id: 'test-responsive', name: 'éŸ¿æ‡‰å¼è¨­è¨ˆ', critical: false }
        ];

        let currentTestIndex = 0;
        let passedTests = 0;
        let failedTests = 0;
        let isRunning = false;

        // æ—¥èªŒå‡½æ•¸
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('testLog');
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            logElement.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // æ›´æ–°æ¸¬è©¦ç‹€æ…‹
        function updateTestStatus(testId, status) {
            const element = document.getElementById(testId);
            element.className = `test-status status-${status}`;
            element.textContent = status === 'success' ? 'é€šé' : 
                                 status === 'error' ? 'å¤±æ•—' : 
                                 status === 'running' ? 'åŸ·è¡Œä¸­' : 'å¾…æ¸¬è©¦';
        }

        // æ›´æ–°é€²åº¦æ¢
        function updateProgress() {
            const progress = (currentTestIndex / tests.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        // æ›´æ–°æ¸¬è©¦çµæœçµ±è¨ˆ
        function updateResults() {
            document.getElementById('total-tests').textContent = tests.length;
            document.getElementById('passed-tests').textContent = passedTests;
            document.getElementById('failed-tests').textContent = failedTests;
            const successRate = tests.length > 0 ? Math.round((passedTests / tests.length) * 100) : 0;
            document.getElementById('success-rate').textContent = `${successRate}%`;
        }

        // æ¨¡æ“¬æ¸¬è©¦åŸ·è¡Œ
        async function runTest(test) {
            updateTestStatus(test.id, 'running');
            log(`é–‹å§‹æ¸¬è©¦: ${test.name}`);
            
            // æ¨¡æ“¬æ¸¬è©¦æ™‚é–“
            const testTime = Math.random() * 2000 + 500;
            await new Promise(resolve => setTimeout(resolve, testTime));
            
            // æ¨¡æ“¬æ¸¬è©¦çµæœï¼ˆ90% æˆåŠŸç‡ï¼‰
            const success = Math.random() > 0.1;
            
            if (success) {
                updateTestStatus(test.id, 'success');
                log(`æ¸¬è©¦é€šé: ${test.name}`, 'success');
                passedTests++;
            } else {
                updateTestStatus(test.id, 'error');
                log(`æ¸¬è©¦å¤±æ•—: ${test.name} - æ¨¡æ“¬éŒ¯èª¤`, 'error');
                failedTests++;
            }
            
            updateResults();
        }

        // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
        async function runAllTests() {
            if (isRunning) return;
            
            isRunning = true;
            resetTests();
            log('é–‹å§‹åŸ·è¡Œå…¨éƒ¨æ¸¬è©¦...');
            
            for (let i = 0; i < tests.length; i++) {
                currentTestIndex = i;
                updateProgress();
                await runTest(tests[i]);
            }
            
            currentTestIndex = tests.length;
            updateProgress();
            log('æ‰€æœ‰æ¸¬è©¦åŸ·è¡Œå®Œæˆï¼', 'success');
            isRunning = false;
        }

        // åŸ·è¡Œé—œéµæ¸¬è©¦
        async function runCriticalTests() {
            if (isRunning) return;
            
            isRunning = true;
            resetTests();
            log('é–‹å§‹åŸ·è¡Œé—œéµæ¸¬è©¦...');
            
            const criticalTests = tests.filter(test => test.critical);
            
            for (let i = 0; i < criticalTests.length; i++) {
                currentTestIndex = i;
                updateProgress();
                await runTest(criticalTests[i]);
            }
            
            currentTestIndex = criticalTests.length;
            updateProgress();
            log('é—œéµæ¸¬è©¦åŸ·è¡Œå®Œæˆï¼', 'success');
            isRunning = false;
        }

        // é‡ç½®æ¸¬è©¦
        function resetTests() {
            currentTestIndex = 0;
            passedTests = 0;
            failedTests = 0;
            
            tests.forEach(test => {
                updateTestStatus(test.id, 'pending');
            });
            
            updateProgress();
            updateResults();
            document.getElementById('testLog').textContent = 'æ¸¬è©¦å·²é‡ç½®ï¼Œç­‰å¾…é–‹å§‹...\n';
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateResults();
            log('ç³»çµ±æ•´åˆæ¸¬è©¦å·¥å…·å·²è¼‰å…¥');
            log('é»æ“ŠæŒ‰éˆ•é–‹å§‹æ¸¬è©¦');
        });
    </script>
</body>
</html>
