# 基礎功能完善設計文檔 (最終版)

## 1. 設計概述

### 1.1 設計目標
建立完整的基礎功能設計方案，包括用戶界面設計、資料架構設計和系統整合設計，確保所有新增功能與現有系統的無縫整合，提供優秀的用戶體驗和穩固的技術基礎。

### 1.2 設計原則
- **一致性**：遵循現有的設計語言和技術架構模式
- **簡潔性**：介面簡潔明瞭，代碼結構清晰
- **效率性**：優化操作流程和系統效能
- **可擴展性**：為未來功能擴展預留空間
- **可維護性**：確保代碼易於理解和修改

## 2. UI 組件設計

### 2.1 收入管理組件設計

#### 2.1.1 收入新增頁面 (IncomeAdd.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：新增收入                    │
├─────────────────────────────────────┤
│ 表單區域                            │
│ ┌─────────────┬─────────────────────┐ │
│ │ 類別選擇     │ 金額輸入             │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 日期選擇     │ 捐款人               │ │
│ ├─────────────┴─────────────────────┤ │
│ │ 說明 (多行文字輸入)                │ │
│ └─────────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 操作按鈕：[取消] [儲存]              │
└─────────────────────────────────────┘
```

**設計要點：**
- 使用 Element Plus 的 el-form 組件
- 表單採用兩欄布局，響應式調整
- 類別選擇使用下拉選單，顯示顏色標識
- 金額輸入使用數字輸入框，支援千分位顯示
- 日期選擇使用日期選擇器，預設今日
- 表單驗證即時顯示，錯誤訊息清晰

#### 2.1.2 收入類別管理頁面 (IncomeCategories.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：收入類別管理 [新增類別]     │
├─────────────────────────────────────┤
│ 類別列表                            │
│ ┌─────┬──────────┬────────┬────────┐ │
│ │顏色 │ 類別名稱  │ 描述    │ 操作   │ │
│ ├─────┼──────────┼────────┼────────┤ │
│ │ ●   │ 香油錢    │ 信眾... │[編輯]  │ │
│ │ ●   │ 點光明燈  │ 點燈... │[編輯]  │ │
│ └─────┴──────────┴────────┴────────┘ │
└─────────────────────────────────────┘
```

**設計要點：**
- 使用表格展示類別列表
- 顏色欄位顯示圓點色塊
- 支援拖拽排序功能
- 新增/編輯使用對話框模式
- 預設類別不可刪除，顯示標識

### 2.2 支出管理組件設計

#### 2.2.1 支出記錄列表頁面 (ExpenseList.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：支出記錄                   │
├─────────────────────────────────────┤
│ 工具列                              │
│ [日期範圍] [類別篩選] [搜尋] [新增]   │
├─────────────────────────────────────┤
│ 統計摘要                            │
│ [記錄筆數] [總金額] [平均] [最大]     │
├─────────────────────────────────────┤
│ 資料表格                            │
│ 日期 │ 類別 │ 金額 │ 廠商 │ 說明 │操作│
├─────────────────────────────────────┤
│ 分頁控制                            │
└─────────────────────────────────────┘
```

**設計要點：**
- 複用收入列表的設計模式
- 支出金額使用紅色顯示
- 廠商欄位取代捐款人欄位
- 支援收據/發票附件預覽

#### 2.2.2 支出新增頁面 (ExpenseAdd.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：新增支出                   │
├─────────────────────────────────────┤
│ 表單區域                            │
│ ┌─────────────┬─────────────────────┐ │
│ │ 類別選擇     │ 金額輸入             │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 日期選擇     │ 廠商/收款人          │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 收據編號     │ 附件上傳             │ │
│ ├─────────────┴─────────────────────┤ │
│ │ 說明 (多行文字輸入)                │ │
│ └─────────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 操作按鈕：[取消] [儲存]              │
└─────────────────────────────────────┘
```

**設計要點：**
- 與收入新增頁面保持一致的布局
- 新增收據編號和附件上傳功能
- 附件支援圖片預覽和 PDF 顯示
- 表單驗證規則適配支出特性

### 2.3 其他核心頁面設計

#### 2.3.1 結餘管理頁面 (Balance.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：結餘管理                   │
├─────────────────────────────────────┤
│ 當前結餘概覽                        │
│ ┌─────────────┬─────────────────────┐ │
│ │ 期初結餘     │ NT$ 100,000         │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 本期收入     │ NT$ 50,000          │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 本期支出     │ NT$ 30,000          │ │
│ ├─────────────┼─────────────────────┤ │
│ │ 期末結餘     │ NT$ 120,000         │ │
│ └─────────────┴─────────────────────┘ │
├─────────────────────────────────────┤
│ 結餘調整                            │
│ [調整金額] [調整原因] [確認調整]      │
└─────────────────────────────────────┘
```

#### 2.3.2 個人設定頁面 (Profile.vue)
```
頁面結構：
┌─────────────────────────────────────┐
│ 頁面標題：個人設定                   │
├─────────────────────────────────────┤
│ 基本資訊                            │
│ ┌─────────────────────────────────┐   │
│ │ 姓名：[輸入框]                   │   │
│ │ 職位：[輸入框]                   │   │
│ │ 電子郵件：[輸入框]               │   │
│ └─────────────────────────────────┘   │
├─────────────────────────────────────┤
│ 偏好設定                            │
│ ┌─────────────────────────────────┐   │
│ │ 預設日期格式：[選擇器]           │   │
│ │ 貨幣顯示格式：[選擇器]           │   │
│ │ 每頁顯示筆數：[選擇器]           │   │
│ └─────────────────────────────────┘   │
└─────────────────────────────────────┘
```

## 3. 交互設計

### 3.1 導航設計
- 保持現有側邊欄導航結構
- 新增頁面自動整合到對應選單
- 麵包屑導航顯示當前位置
- 支援鍵盤快捷鍵操作

### 3.2 表單交互
- 即時驗證，錯誤訊息即時顯示
- 必填欄位標記清晰
- 提交時顯示載入狀態
- 成功/失敗訊息明確反饋

### 3.3 資料展示
- 表格支援排序、篩選、搜尋
- 分頁載入，避免效能問題
- 空狀態設計友好
- 載入狀態視覺化

## 4. 響應式設計

### 4.1 斷點設計
- 桌面版：≥ 1200px
- 平板版：768px - 1199px  
- 手機版：< 768px

### 4.2 布局適配
- 桌面版：雙欄表單布局
- 平板版：單欄表單布局
- 手機版：堆疊式布局，優化觸控操作

## 5. 視覺設計規範

### 5.1 色彩系統
- 主色：#409EFF (藍色)
- 成功：#67C23A (綠色)
- 警告：#E6A23C (橙色)
- 危險：#F56C6C (紅色)
- 資訊：#909399 (灰色)

### 5.2 字體系統
- 標題：16px-24px，字重 600
- 正文：14px，字重 400
- 輔助文字：12px，字重 400

### 5.3 間距系統
- 基礎間距：8px
- 組件間距：16px
- 區塊間距：24px
- 頁面邊距：20px

## 6. 組件復用策略

### 6.1 共用組件
- FormCard：表單卡片容器
- DataTable：資料表格組件
- CategorySelector：類別選擇器
- AmountInput：金額輸入組件
- FileUpload：檔案上傳組件

### 6.2 組件庫擴展
- 基於 Element Plus 進行客製化
- 建立專案特定的設計 token
- 統一的主題配置

## 7. 可訪問性設計

### 7.1 鍵盤導航
- 所有交互元素支援 Tab 鍵導航
- 明確的焦點指示器
- 合理的 Tab 順序

### 7.2 螢幕閱讀器支援
- 適當的 ARIA 標籤
- 語義化的 HTML 結構
- 圖片提供替代文字

## 8. 資料架構設計

### 8.1 支出記錄資料結構
```javascript
const ExpenseSchema = {
  id: Number,           // 唯一識別碼
  categoryId: Number,   // 類別ID
  amount: Number,       // 金額 (正數)
  date: String,         // 支出日期 (YYYY-MM-DD)
  description: String,  // 說明
  vendor: String,       // 廠商/收款人
  receipt: String,      // 收據編號
  attachments: Array,   // 附件列表
  createdAt: String,    // 建立時間 (ISO)
  updatedAt: String,    // 更新時間 (ISO)
  status: String        // 狀態 (active/deleted)
}
```

### 8.2 Pinia Store 設計模式
```javascript
// stores/expense.js 基本結構
export const useExpenseStore = defineStore('expense', () => {
  // 狀態
  const expenses = ref([])
  const categories = ref([])
  const loading = ref(false)

  // 計算屬性
  const totalExpense = computed(() =>
    expenses.value.reduce((sum, expense) => sum + expense.amount, 0)
  )

  // 方法
  const addExpense = async (expenseData) => { /* 實現邏輯 */ }
  const updateExpense = async (id, data) => { /* 實現邏輯 */ }
  const deleteExpense = async (id) => { /* 實現邏輯 */ }

  return { expenses, categories, loading, totalExpense, addExpense, updateExpense, deleteExpense }
})
```

## 9. 系統整合設計

### 9.1 模組化架構
```
src/
├── components/
│   ├── common/          # 共用組件
│   └── business/        # 業務組件
├── views/               # 頁面組件
├── stores/              # 狀態管理
├── services/            # 服務層
├── utils/               # 工具函數
└── composables/         # 組合式函數
```

### 9.2 錯誤處理機制
- 統一的錯誤處理類
- 用戶友好的錯誤訊息
- 錯誤日誌記錄
- 自動錯誤恢復

### 9.3 效能優化策略
- 組件懶載入
- 資料分頁載入
- 計算結果快取
- 圖片優化處理

## 10. 設計驗收標準

### 10.1 UI 驗收
- [ ] 與現有頁面視覺風格一致
- [ ] 色彩使用符合設計規範
- [ ] 字體和間距統一
- [ ] 操作流程直觀順暢
- [ ] 響應式設計在各設備正常

### 10.2 功能驗收
- [ ] 所有 CRUD 操作正常
- [ ] 資料驗證機制完整
- [ ] 統計計算準確
- [ ] 錯誤處理友好

### 10.3 技術驗收
- [ ] 代碼結構清晰可維護
- [ ] 效能指標符合要求
- [ ] 模組整合運作正常
- [ ] 測試覆蓋率充足
